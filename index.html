<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Farias iPhones Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#000;
  color:#fff;
}
.container{
  max-width:1000px;
  margin:auto;
  padding:20px;
}
.product{
  display:flex;
  flex-wrap:wrap;
  gap:40px;
  align-items:center;
}
.gallery{flex:1;}
.main-img{
  width:100%;
  border-radius:12px;
}
.thumbs{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.thumbs img{
  width:70px;
  border-radius:8px;
  cursor:pointer;
  opacity:0.7;
  transition:0.3s;
}
.thumbs img:hover{opacity:1;}
.info{flex:1;}
button{
  margin-top:20px;
  padding:12px 20px;
  background:#22c55e;
  border:none;
  color:#fff;
  font-size:16px;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="container">
  <div class="product">
    
    <div class="gallery">
      <img id="mainImage" class="main-img">
      <div class="thumbs" id="thumbs"></div>
    </div>

    <div class="info">
      <h2 id="nome"></h2>
      <p id="descricao"></p>
      <h3 id="preco"></h3>
      <button onclick="comprar()">Comprar no WhatsApp</button>
    </div>

  </div>
</div>

<script>
const supabase = window.supabase.createClient(
  "https://bzgvbghxmebdjqnlakbj.supabase.co",
  "sb_publishable_IyvZNwtgkvECR0QVlYbhzw_zPL1TMJv"
);

let produtoAtual = null;

async function carregarProduto(){

  const { data: produto, error } = await supabase
    .from("produtos")
    .select("*")
    .eq("destaque", true)
    .single();

  if(error){
    console.error("Erro produto:", error);
    return;
  }

  produtoAtual = produto;

  document.getElementById("nome").innerText = produto.nome;
  document.getElementById("descricao").innerText = produto.descricao;
  document.getElementById("preco").innerText = "R$ " + produto.preco;

  const { data: imagens, error: erroImg } = await supabase
    .from("imagens_produto")
    .select("*")
    .eq("produto_id", produto.id);

  if(erroImg){
    console.error("Erro imagens:", erroImg);
    return;
  }

  if(imagens.length > 0){
    document.getElementById("mainImage").src = imagens[0].url;

    const thumbs = document.getElementById("thumbs");
    thumbs.innerHTML = "";

    imagens.forEach(img=>{
      thumbs.innerHTML += `
        <img src="${img.url}" onclick="trocarImagem('${img.url}')">
      `;
    });
  }

}

function trocarImagem(url){
  document.getElementById("mainImage").src = url;
}

function comprar(){
  window.open(
    `https://wa.me/55SEUNUMERO?text=Quero comprar ${produtoAtual.nome}`
  );
}

carregarProduto();
</script>

</body>
</html>
